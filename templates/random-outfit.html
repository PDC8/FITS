<!-- random-outfit.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Random Outfit - Digital Closet</title>
  <link rel="stylesheet" href="/static/base.css" />
  <link rel="stylesheet" href="/static/random-outfit.css" />
</head>
<body>
  <header>
    <nav class="main-nav">
      <div class="nav-section left-links">
        <a href="/upload">Upload</a>
        <a href="/random-outfit">Generate</a>
      </div>
      <div class="logo">
        <img src="logo.png" alt="Logo">
      </div>
      <div class="nav-section right-links">
        <a href="/search">Search</a>
        <a href="/logout">Profile</a>
      </div>
    </nav>
  </header>

  <main class="outfit-generator">
    <!-- Preferences/Weather Input Field -->
    <div class="preferences-container">
      <label for="preferencesInput" class="preferences-label">
        Preferences / Weather:
      </label>
      <input 
        type="text" 
        id="preferencesInput" 
        name="preferencesInput" 
        class="preferences-input" 
        placeholder="E.g. sunny, formal, etc."
      />
    </div>

    <button class="generate-btn" type="button">
      Generate Outfit
    </button>

    <!-- Save Outfit Button -->
    <button class="save-btn" type="button">
      Save Outfit
    </button>

    <div class="outfit-result">
      <!-- 
        When you click the button, the JavaScript will call the backend endpoint 
        and populate this container with the chosen items (e.g. top, bottom, shoes).
      -->
      <p class="placeholder">Click "Generate Outfit" to see a new look!</p>
    </div>
  </main>
  
  <script>
    document.querySelector('.generate-btn').addEventListener('click', async () => {
      try {
        const response = await fetch('/api/outfit/random');
        const outfit = await response.json();
        const resultsDiv = document.querySelector('.outfit-result');
        resultsDiv.innerHTML = ''; // Clear previous results
        
        // Create a container to display the outfit
        const outfitContainer = document.createElement('div');
        outfitContainer.className = 'outfit-container';
        
        // Define the display order
        const order = ['tops', 'bottoms', 'shoes'];
        
        // Loop through in fixed order
        order.forEach(category => {
          const item = outfit[category];
          const itemDiv = document.createElement('div');
          itemDiv.className = 'outfit-item';
          if (item) {
            let html = `<h3>${category.toUpperCase()}</h3>`;
            html += `<p><strong>Name:</strong> ${item.item_name}</p>`;
            if (item.type_name) {
              html += `<p><strong>Type:</strong> ${item.type_name}</p>`;
            }
            if (item.brand_name) {
              html += `<p><strong>Brand:</strong> ${item.brand_name}</p>`;
            }
            if (item.size_name) {
              html += `<p><strong>Size:</strong> ${item.size_name}</p>`;
            }
            if (item.color_names && item.color_names.length > 0) {
              html += `<p><strong>Color(s):</strong> ${item.color_names.join(', ')}</p>`;
            }
            if (item.fabric_names && item.fabric_names.length > 0) {
              html += `<p><strong>Fabric(s):</strong> ${item.fabric_names.join(', ')}</p>`;
            }
            if (item.item_image) {
              html += `<img src="data:image/png;base64,${item.item_image}" alt="${item.item_name}" width="150">`;
            }
            itemDiv.innerHTML = html;
          } else {
            itemDiv.innerHTML = `<h3>${category.toUpperCase()}</h3><p>No item available</p>`;
          }
          outfitContainer.appendChild(itemDiv);
        });
        resultsDiv.appendChild(outfitContainer);
      } catch (error) {
        console.error('Error generating outfit:', error);
      }
    });
  </script>  
  
</body>
</html>
