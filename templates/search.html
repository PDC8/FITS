<!-- search.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Search Closet - Digital Closet</title>
  <link rel="stylesheet" href="/static/search.css" />
</head>
<body>
  <header>
    <h1>Search Your Closet</h1>
  </header>

  <main class="search-container">
    <form class="search-form" action="/api/clothing" method="GET">
      <label for="item_name">Search:</label>
      <input type="text" id="item_name" name="item_name" placeholder="e.g. 'blue shirt'" />

      <label for="type_id">Type:</label>
      <select id="type_id" name="type_id">
        <option value="">All Types</option>
        <option value="1">Shirt</option>
        <option value="2">Pants</option>
        <option value="3">Shoes</option>
      </select>

      <button type="submit">Find Items</button>
    </form>

    <!-- Results area -->
    <div class="search-results">
      <!-- In real usage, populate results here from the database query. -->
      <p class="placeholder">No items found yet. Try searching.</p>
    </div>

    <script>
      async function fetchResults(event) {
        if (event) event.preventDefault();
  
        const form = document.querySelector('.search-form');
        const query = new URLSearchParams(new FormData(form)).toString();
        const response = await fetch(`/api/clothing?${query}`);
        const data = await response.json();
  
        const resultsContainer = document.getElementById('search-results');
        resultsContainer.innerHTML = '';
  
        if (data.length === 0) {
          resultsContainer.innerHTML = '<p>No items found.</p>';
          return;
        }
  
        data.forEach(item => {
          const itemElement = document.createElement('div');
          itemElement.classList.add('item');
          
          const img = document.createElement('img');
          if (item.item_image) {
            img.src = `data:image/jpeg;base64,${item.item_image}`;
            img.alt = item.item_name || 'Clothing Item';
          } else {
            img.src = '/static/placeholder.jpg';
            img.alt = 'Placeholder Image';
          }
          print("HELP")
  
          const name = document.createElement('p');
          name.textContent = `Name: ${item.item_name}`;
  
          const type = document.createElement('p');
          type.textContent = `Type: ${item.type_name || 'Unknown'}`;
  
          itemElement.appendChild(img);
          itemElement.appendChild(name);
          itemElement.appendChild(type);
          resultsContainer.appendChild(itemElement);
        });
      }
  
      document.querySelector('.search-form').addEventListener('submit', fetchResults);
  
      // Fetch all items on initial load
      window.addEventListener('load', fetchResults);
    </script>
  </main>
</body>
</html>
