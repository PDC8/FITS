<!-- search.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Search Closet - Digital Closet</title>
  <link rel="stylesheet" href="/static/search.css" />
</head>
<body>
  <header>
    <h1>Search Your Closet</h1>
  </header>

  <nav class="main-nav">
    <ul>
      <!-- Back button to return to home -->
      <li><a href="/">Back to home</a></li>
    </ul>
  </nav>

  <main class="search-container">
    <form class="search-form" action="/api/clothing" method="GET">
      <label for="item_name">Search:</label>
      <input type="text" id="item_name" name="item_name" placeholder="e.g. 'blue shirt'" />

      <label for="type_id">Type:</label>
      <select id="type_id" name="type_id">
        <option value="">All Types</option>
        <option value="1">Shirt</option>
        <option value="2">Pants</option>
        <option value="3">Shoes</option>
      </select>

      <label for="brand_id">Brand:</label>
      <select id="brand_id" name="brand_id" multiple>
        <option value="1">Nike</option>
        <option value="2">Adidas</option>
        <option value="3">Zara</option>
        <option value="4">H&M</option>
        <option value="5">Uniqlo</option>
        <option value="6">Levi's</option>
        <option value="7">Gucci</option>
        <option value="8">Louis Vuitton</option>
        <option value="9">Under Armour</option>
        <option value="10">Puma</option>
      </select>
      
      <label for="size_id">Size:</label>
      <select id="size_id" name="size_id" multiple>
        <option value="1">XS</option>
        <option value="2">S</option>
        <option value="3">M</option>
        <option value="4">L</option>
        <option value="5">XL</option>
        <option value="6">26</option>
        <option value="7">27</option>
        <option value="8">28</option>
        <option value="9">29</option>
        <option value="10">30</option>
        <option value="11">31</option>
        <option value="12">32</option>
        <option value="13">33</option>
        <option value="14">34</option>
        <option value="15">35</option>
      </select>      

      <label for="color_id">Color:</label>
      <select id="color_id" name="color_id" multiple>
        <option value="1">Red</option>
        <option value="2">Orange</option>
        <option value="3">Yellow</option>
        <option value="4">Green</option>
        <option value="5">Blue</option>
        <option value="6">Indigo</option>
        <option value="7">Violet</option>
      </select>

      <label for="fabric_id">Fabric:</label>
      <select id="fabric_id" name="fabric_id" multiple>
        <option value="1">Cotton</option>
        <option value="2">Linen</option>
        <option value="3">Hemp</option>
        <option value="4">Wool</option>
        <option value="5">Cashmere</option>
        <option value="6">Silk</option>
        <option value="7">Polyester</option>
        <option value="8">Nylon</option>
        <option value="9">Spandex</option>
        <option value="10">Acrylic</option>
      </select>

      <button type="submit">Find Items</button>
    </form>

    <!-- Results area -->
    <div class="search-results">
      <!-- In real usage, populate results here from the database query. -->
      <p class="placeholder">No items found yet. Try searching.</p>
    </div>
  </main>
  <script>
    document.querySelector('.search-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Get form data
      const formData = new URLSearchParams(new FormData(e.target));
      
      try {
        const response = await fetch(`/api/clothing?${formData}`);
        const items = await response.json();
        
        const resultsDiv = document.querySelector('.search-results');
        resultsDiv.innerHTML = '';
        
        if (items.length > 0) {
          // Create grid container
          const grid = document.createElement('div');
          grid.className = 'results-grid';
          
          items.forEach(item => {
            const itemCard = document.createElement('div');
            itemCard.className = 'item-card';
            
            const imageContent = item.item_image 
              ? `<img src="data:image/png;base64,${item.item_image}" alt="${item.item_name}" style="max-width:150px; max-height:150px;">`
              : '<div class="no-image">No Image Available</div>';

            
            itemCard.innerHTML = `
              <div class="item-image">${imageContent}</div>
              <h3 class="item-name">${item.item_name}</h3>
            `;
            
            grid.appendChild(itemCard);
          });
          
          resultsDiv.appendChild(grid);
        } else {
          resultsDiv.innerHTML = '<p class="no-results">No items found matching your search</p>';
        }
      } catch (error) {
        console.error('Error:', error);
      }
    });
  
    // Load all items on page load
    window.addEventListener('DOMContentLoaded', async () => {
      try {
        const response = await fetch('/api/clothing');
        const items = await response.json();
        document.querySelector('.search-form').dispatchEvent(new Event('submit'));
      } catch (error) {
        console.error('Error:', error);
      }
    });
  </script>
  
</body>
</html>
